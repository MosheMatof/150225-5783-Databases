CREATE OR REPLACE VIEW BUYERS_DETAILS AS
SELECT "BUYER_ID","BUYER_EMAIL","BUYER_NAME","BUYER_PHONE","CLUB_ID"
FROM BUYERS
WHERE buyer_id IN (SELECT DISTINCT buyer_id FROM TICKET_SALES);

CREATE OR REPLACE VIEW BUYERS_TICKET_SALES AS
SELECT "BUYER_ID","BUYER_EMAIL","BUYER_NAME","BUYER_PHONE","CLUB_ID"
FROM Buyers
WHERE buyer_id IN (SELECT DISTINCT buyer_id FROM Ticket_Sales);


CREATE OR REPLACE VIEW BUYERS_PURCHASE_COUNT AS
SELECT Buyers.buyer_name, COUNT(Ticket_Sales.buyer_id) AS purchase_count
FROM Buyers
JOIN Ticket_Sales ON Buyers.buyer_id = Ticket_Sales.buyer_id
GROUP BY Buyers.buyer_name;
